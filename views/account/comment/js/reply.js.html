(function(){
  var wjtreplylistV=new Vue({
    el:"#wjtreplylist",
    data:{
      page:1,
      totalPage:0,
      list:[],
    },
    methods:{
      render:function(){
        $.ajax({
          url: '/account/comment/reply/_api/list?count=5&page='+this.page,
          type: 'GET',
          dataType: 'json',
          cache:false,
          success:function(data){
            console.log(data);
            if (data.status){
              wjtreplylistV.page=data.data.paging.curPage;
              wjtreplylistV.totalPage=data.data.paging.totalPage;
              wjtreplylistV.list= data.data.data;
              wjtreplylistV.renderPaging();
            }
          }
        });
      },
      renderPaging:function(){
          var paginghtml = Paging.render({
              currentPage: this.page,
              pageCount: this.totlePage,
              link:''
          });
          $("#wjtlistpage").empty();
          $("#wjtlistpage").html(paginghtml);
      }
    }
  });
  var Tpage = {
    run:function() {
      setTimeout(function(){
        Tpage.bind();
      },0);
      setTimeout(function(){
        wjtreplylistV.render();
      },0);
    },
    bind:function() {
      $("#wjtlistpage").on('click', 'a.ui-paging-item,a.ui-paging-next,a.ui-paging-prev', function () {
          $('.ui-paging-current').removeClass('ui-paging-current');
          $(this).addClass('ui-paging-current');
          var $this = $(this);
          wjtreplylistV.page = $this.attr('href');
          wjtreplylistV.render();
          return false
      })
      .on('click', '.ui-paging-goto', function () {
          var $this = $(this);
          var $input = $this.prev('.ui-paging-which').find('input')
          var value = $input.val()
          // 必须填入数字
          value = parseInt(value, 10)
          if (isNaN(value)) {
              value = 1;
          }
          if (value>wjtreplylistV.totalPage){
            value=wjtreplylistV.totalPage;
          }
          wjtreplylistV.page = value;
          wjtreplylistV.render();
          return false;
      })
    }
  }
  Tpage.run();
})();
