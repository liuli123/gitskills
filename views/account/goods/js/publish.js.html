  <!-- 滚动特效 -->
  var Speed_1 = 10; //速度(毫秒)
  var Space_1 = 20; //每次移动(px)
  var PageWidth_1 = 1088; //翻页宽度
  var interval_1 = 5000; //翻页间隔时间
  var fill_1 = 0; //整体移位
  var MoveLock_1 = false;
  var MoveTimeObj_1;
  var MoveWay_1="right";
  var Comp_1 = 0;
  var AutoPlayObj_1=null;
  function GetObj(objName){if(document.getElementById){return eval('document.getElementById("'+objName+'")')}else{return eval('document.all.'+objName)}}
  function AutoPlay_1(){clearInterval(AutoPlayObj_1);AutoPlayObj_1=setInterval('ISL_GoDown_1();ISL_StopDown_1();',interval_1)}
  function ISL_GoUp_1(){if(MoveLock_1)return;clearInterval(AutoPlayObj_1);MoveLock_1=true;MoveWay_1="left";MoveTimeObj_1=setInterval('ISL_ScrUp_1();',Speed_1);}
  function ISL_StopUp_1(){if(MoveWay_1 == "right"){return};clearInterval(MoveTimeObj_1);if((GetObj('ISL_Cont_1').scrollLeft-fill_1)%PageWidth_1!=0){Comp_1=fill_1-(GetObj('ISL_Cont_1').scrollLeft%PageWidth_1);CompScr_1()}else{MoveLock_1=false}
  AutoPlay_1()}
  function ISL_ScrUp_1(){if(GetObj('ISL_Cont_1').scrollLeft<=0){GetObj('ISL_Cont_1').scrollLeft=GetObj('ISL_Cont_1').scrollLeft+GetObj('List1_1').offsetWidth}
  GetObj('ISL_Cont_1').scrollLeft-=Space_1}
  function ISL_GoDown_1(){clearInterval(MoveTimeObj_1);if(MoveLock_1)return;clearInterval(AutoPlayObj_1);MoveLock_1=true;MoveWay_1="right";ISL_ScrDown_1();MoveTimeObj_1=setInterval('ISL_ScrDown_1()',Speed_1)}
  function ISL_StopDown_1(){if(MoveWay_1 == "left"){return};clearInterval(MoveTimeObj_1);if(GetObj('ISL_Cont_1').scrollLeft%PageWidth_1-(fill_1>=0?fill_1:fill_1+1)!=0){Comp_1=PageWidth_1-GetObj('ISL_Cont_1').scrollLeft%PageWidth_1+fill_1;CompScr_1()}else{MoveLock_1=false}
  AutoPlay_1()}
  function ISL_ScrDown_1(){if(GetObj('ISL_Cont_1').scrollLeft>=GetObj('List1_1').scrollWidth){GetObj('ISL_Cont_1').scrollLeft=GetObj('ISL_Cont_1').scrollLeft-GetObj('List1_1').scrollWidth}
  GetObj('ISL_Cont_1').scrollLeft+=Space_1}
  function CompScr_1(){if(Comp_1==0){MoveLock_1=false;return}
  var num,TempSpeed=Speed_1,TempSpace=Space_1;if(Math.abs(Comp_1)<PageWidth_1/2){TempSpace=Math.round(Math.abs(Comp_1/Space_1));if(TempSpace<1){TempSpace=1}}
  if(Comp_1<0){if(Comp_1<-TempSpace){Comp_1+=TempSpace;num=TempSpace}else{num=-Comp_1;Comp_1=0}
  GetObj('ISL_Cont_1').scrollLeft-=num;setTimeout('CompScr_1()',TempSpeed)}else{if(Comp_1>TempSpace){Comp_1-=TempSpace;num=TempSpace}else{num=Comp_1;Comp_1=0}
  GetObj('ISL_Cont_1').scrollLeft+=num;setTimeout('CompScr_1()',TempSpeed)}}
  function picrun_ini(){
  GetObj("List2_1").innerHTML=GetObj("List1_1").innerHTML;
  GetObj('ISL_Cont_1').scrollLeft=fill_1>=0?fill_1:GetObj('List1_1').scrollWidth-Math.abs(fill_1);
  GetObj("ISL_Cont_1").onmouseover=function(){clearInterval(AutoPlayObj_1)}
  GetObj("ISL_Cont_1").onmouseout=function(){AutoPlay_1()}
  AutoPlay_1();
  }
var cisneindex = 0;
  var prosearchlistshowtype="flipInX";
  var prosearchlisthidetype="flipOutX";
  var prosearchlistselecthidetype = "zoomOut";
  var getProListForValue = function(value,next) {
    $.ajax({
      url: '/account/goods/publish/_api/products/'+value,
      dataType: 'json',
      cache:false,
    })
    .done(function(data) {
      if (data.status){
        next(data.data);
      }
    })
    .fail(function() {
      console.log("error");
    });

  };
  var inputChange = function(index) {
    var prl = $("#wjt1287dh"+index);
    var vafd=$.trim(prl.val());
    if (vafd.length >0){
      getProListForValue(vafd,function(data){
        if (!prl.hasClass(prosearchlistshowtype)) {
          $("#wjtsdfiie"+index).addClass(prosearchlistshowtype);
          $("#wjtsdfiie"+index).show();
          var html = template('wjtidhower',{"list":data,"inde":index});
          $('.wjtcipwenr'+index).empty();
          $('.wjtcipwenr'+index).append(html);
        }
      });
    } else {
        hideProSearchList($("#wjtsdfiie"+index),prosearchlisthidetype,false,function(){
        });
    }
  };
  var   hideProSearchList=function($el,hidetype,isremove,next){
      $el.removeClass(prosearchlistshowtype);
      $el.addClass(hidetype);
      $el.removeClass(hidetype);
      if (isremove)
        $el.remove();
      else
        $el.hide();
        next();
    };
var wjtNewMoreHtml = function() {
  cisneindex++;
  $(".wjtcwekrnsd").remove();
  $("#wjtcinwer").append(template('wjtdcjtpl',{index:cisneindex}));
}
wjtNewMoreHtml();
var sizes = new Array();
var sM =new Map();
var wjtsearchproselect = function(inde,element) {
  var proid = $(element).attr("data-id");
  for (var i = 0; i < sizes.length; i++) {
    if (proid===sizes[i]){
      alert("已经有该货号了");
      return;
    }
  }
  if (hasInventory(proid)){
    alert("您已经有该货的库存, 请在[我的库存]内编辑");
    return;
  }
  var inde = $(element).parent().attr("data-index");
  var $prldiv = $(element).parent().parent().parent().parent().parent();
  var $nameIpt = $("#wjt1287dh"+inde);
  var $nameIptPr = $nameIpt.parent();
  $nameIpt.remove();
  hideProSearchList($prldiv,prosearchlistselecthidetype,true,function(){

  });
  $nameIptPr.append($(element).attr("data-pid"));
  sizes[sizes.length] = proid;
  $('#wjtjjc91'+inde).attr('src',$(element).attr("data-image"));
  $('#wjtjjc91'+inde).show();
  $('#wjtujcjioe'+inde).append($(element).attr("data-name"));
  $('#wjtucyqwer'+inde).empty();
  $('#wjtucyqwer'+inde).append(template('wjtoiciwuerkd',{sizes:$(element).attr("data-sizes"),inde:inde,'proid':proid}));
  $('#wjtocuwehr'+inde).attr('data-sizes',$(element).attr("data-sizes").toString().split(","));
  $('#wjtnpwer'+inde).show();
}
var wjtselectsize=function(inde) {
  $('#wjtucyqwer'+inde).slideDown('fast');
}

var wjtsizeslect=function(inde,proid){
  $('.wjtiowerfviwer'+inde).remove();
  if ($('.wjticiuwher'+inde+':checked').length>0){
    $('#wjtnpwer'+inde).remove();
    $('.wjticiuwher'+inde+':checked').each(function(index, el) {
      if ($('.'+proid+'_'+$(el).attr('data-size')).length>0){
        alert("已经有"+$(el).attr('data-size')+"尺码!");
      }else{
        $('#wjtocuwehr'+inde).append('<span class="'+proid+'_'+$(el).attr('data-size')+'">'+$(el).attr('data-size')+'</span><br/>');
        $('#wjtseresfwe'+inde).append('<input id="'+proid+'_'+$(el).attr('data-size')+'_count" type="text"><br/>');
        $('#wjtwelro'+inde).append('<input id="'+proid+'_'+$(el).attr('data-size')+'_dprice" type="text"><br/>');
        $('#wjtweroidsf'+inde).append('<input id="'+proid+'_'+$(el).attr('data-size')+'_lprice" type="text"><br/>');
        $('#wjtesoiidfe'+inde).append('<input id="'+proid+'_'+$(el).attr('data-size')+'_weight" type="text"><br/>');
        var s = sM.get(proid);
        if (null===s|| undefined===s){
          s = "";
        }
        s+=$(el).attr('data-size')+',';
        sM.remove(proid);
        if (s!=""){
          sM.put(proid,s);
        }
      }
      if ($('.wjticiuwher'+inde+':checked').length==index+1){
        $('#wjtocuwehr'+inde).append('<a href="javascript:;" id="wjtnpwer'+inde+'" onclick="wjtselectsize('+inde+');">+添加</a>');
      }
    });
  }
  $('#wjtucyqwer'+inde).slideUp('fast');
}

var hasInventory = function(proid){
  $.ajax({
    url: '/account/goods/publish/_api/inventory/check/'+proid,
    type: 'GET',
    dataType: 'json',
    cache:false,
    async:false,
    success:function(data){
      if (data){
        return true;
      }else {
        return false;
      }
    },
    error:function(){
      return false;
    }
  });
}

  var quanxuan =function(i) {
    $('.wjticiuwher'+i).each(function(index, el) {
      $(el).attr('checked', true);
    });
  }

  var publish=function(){
    if (sizes.length<=0||sM.size()<=0){
      alert("没有有效的提交信息!");
      return;
    }
    var qbd={};
    var posu = "";
    for (var i = 0; i < sizes.length; i++) {
      var s = sM.get(sizes[i]);
      if (null!=s&&undefined!=s){
          posu+=sizes[i]+':'+s+'_';
          for (var _in in s.split(',')) {
            if (s.hasOwnProperty(_in)) {
              var sif=s.split(',')[_in];
              if (null!=sif&&undefined!=sif&&sif.length>0){
                qbd[sizes[i]+'_'+sif+'_count'] = $('#'+sizes[i]+'_'+sif+'_count').val();
                qbd[sizes[i]+'_'+sif+'_dprice'] = $('#'+sizes[i]+'_'+sif+'_dprice').val();
                qbd[sizes[i]+'_'+sif+'_lprice'] = $('#'+sizes[i]+'_'+sif+'_lprice').val();
                qbd[sizes[i]+'_'+sif+'_weight'] = $('#'+sizes[i]+'_'+sif+'_weight').val();
              }
            }
          }
      }
    }
    qbd.data=posu;
    $.ajax({
      url: '/account/goods/publish/_api/inventory/publish',
      type: 'POST',
      dataType: 'json',
      cache:false,
      data:qbd,
    })
    .done(function(data) {
      if (data.status){
        alert("成功!");
      }
    })
    .fail(function() {
      console.log("error");
    });

  }
